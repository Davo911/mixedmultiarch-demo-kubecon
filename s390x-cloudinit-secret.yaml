apiVersion: v1
kind: Secret
metadata:
  name: fedora-s390x-cloudinit
  namespace: default
type: Opaque
stringData:
  userdata: |
    #cloud-config
    package_update: true
    packages:
      - nginx
    write_files:
      - path: /usr/share/nginx/html/index.html
        owner: root:root
        permissions: '0644'
        encoding: b64
        content: PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICA8aGVhZD4KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xIiAvPgogICAgPHRpdGxlPkhlbGxvIGZyb20gSUJNIFo8L3RpdGxlPgogICAgPGxpbmsgcmVsPSJwcmVjb25uZWN0IiBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tIiAvPgogICAgPGxpbmsgcmVsPSJwcmVjb25uZWN0IiBocmVmPSJodHRwczovL2ZvbnRzLmdzdGF0aWMuY29tIiBjcm9zc29yaWdpbiAvPgogICAgPGxpbmsKICAgICAgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1JQk0rUGxleCtNb25vOndnaHRANDAwOzYwMCZmYW1pbHk9SUJNK1BsZXgrU2Fuczp3Z2h0QDMwMDs0MDA7NjAwJmRpc3BsYXk9c3dhcCIKICAgICAgcmVsPSJzdHlsZXNoZWV0IgogICAgLz4KICAgIDxzdHlsZT4KICAgICAgOnJvb3QgewogICAgICAgIGNvbG9yLXNjaGVtZTogbGlnaHQ7CiAgICAgIH0KCiAgICAgICogewogICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgIH0KCiAgICAgIGJvZHkgewogICAgICAgIG1hcmdpbjogMDsKICAgICAgICBtaW4taGVpZ2h0OiAxMDB2aDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgcGFkZGluZzogM3JlbSAxLjVyZW07CiAgICAgICAgZm9udC1mYW1pbHk6ICdJQk0gUGxleCBTYW5zJywgLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBzYW5zLXNlcmlmOwogICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxNjBkZWcsICNmNmZiZmYgMCUsICNlMGVmZmYgNDUlLCAjY2ZlNWZmIDEwMCUpOwogICAgICAgIGNvbG9yOiAjMGYyYTRhOwogICAgICB9CgogICAgICAuY29udGVudCB7CiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIGdhcDogMS41cmVtOwogICAgICAgIHdpZHRoOiBtaW4oNTQwcHgsIDEwMCUpOwogICAgICB9CgogICAgICBoMSB7CiAgICAgICAgbWFyZ2luOiAwOwogICAgICAgIGZvbnQtc2l6ZTogY2xhbXAoMi41cmVtLCA2dncsIDMuNXJlbSk7CiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICBsZXR0ZXItc3BhY2luZzogMC4wMWVtOwogICAgICB9CgogICAgICAuaGVyby1pbWFnZSB7CiAgICAgICAgd2lkdGg6IG1pbigzNjBweCwgNzV2dyk7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMS4yNXJlbTsKICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgfQoKICAgICAgLm5vdGUgewogICAgICAgIGZvbnQtc2l6ZTogMC45NXJlbTsKICAgICAgICBsZXR0ZXItc3BhY2luZzogMC4wOGVtOwogICAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICAgICAgY29sb3I6IHJnYmEoMTUsIDQyLCA3NCwgMC42KTsKICAgICAgfQoKICAgICAgLnRlcm1pbmFsIHsKICAgICAgICB3aWR0aDogbWluKDUyMHB4LCA5NXZ3KTsKICAgICAgICBiYWNrZ3JvdW5kOiAjMDIwNDAzOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuOXJlbTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDEwMiwgMjU1LCAxNTMsIDAuMzUpOwogICAgICAgIHBhZGRpbmc6IDEuOHJlbSAxLjZyZW07CiAgICAgICAgYm94LXNoYWRvdzogMCAyMnB4IDQ1cHggcmdiYSgyLCA0LCAzLCAwLjQ1KTsKICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgICAgIGZvbnQtZmFtaWx5OiAnSUJNIFBsZXggTW9ubycsICdTRk1vbm8tUmVndWxhcicsIENvbnNvbGFzLCAnTGliZXJhdGlvbiBNb25vJywgTWVubG8sIG1vbm9zcGFjZTsKICAgICAgICBjb2xvcjogIzY0ZmY5ZjsKICAgICAgfQoKICAgICAgLnRlcm1pbmFsIHByZSB7CiAgICAgICAgbWFyZ2luOiAwOwogICAgICAgIHdoaXRlLXNwYWNlOiBwcmU7CiAgICAgICAgZm9udC1zaXplOiAxLjA1cmVtOwogICAgICAgIGxpbmUtaGVpZ2h0OiAxLjY7CiAgICAgIH0KCiAgICAgIC50ZXJtaW5hbCAuY3Vyc29yIHsKICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgICAgd2lkdGg6IDAuNjVjaDsKICAgICAgICBhbmltYXRpb246IGJsaW5rIDEuMXMgc3RlcHMoMiwgc3RhcnQpIGluZmluaXRlOwogICAgICB9CgogICAgICBAa2V5ZnJhbWVzIGJsaW5rIHsKICAgICAgICAwJSwKICAgICAgICA0OSUsCiAgICAgICAgMTAwJSB7CiAgICAgICAgICBvcGFjaXR5OiAxOwogICAgICAgIH0KICAgICAgICA1MCUsCiAgICAgICAgOTklIHsKICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgfQogICAgICB9CiAgICA8L3N0eWxlPgogIDwvaGVhZD4KICA8Ym9keT4KICAgIDxkaXYgY2xhc3M9ImNvbnRlbnQiPgogICAgICA8aW1nCiAgICAgICAgc3JjPSJodHRwczovL2Rhdm85MTEuZ2l0aHViLmlvL3MzOTB4U2VydmVyLnBuZyIKICAgICAgICBhbHQ9IlN0eWxpemVkIElCTSBaIG1haW5mcmFtZSBzZXJ2ZXIgaWxsdXN0cmF0aW9uIgogICAgICAgIGNsYXNzPSJoZXJvLWltYWdlIgogICAgICAvPgogICAgICA8cCBjbGFzcz0ibm90ZSI+U2VydmVkIGZyb20gczM5MHggTm9kZTogdDMxM2xwMDYub2NwNi50ZXN0Lm1haW56PC9wPgogICAgICA8ZGl2IGNsYXNzPSJ0ZXJtaW5hbCIgcm9sZT0icmVnaW9uIiBhcmlhLWxhYmVsPSJMZWdhY3kgbWFpbmZyYW1lIHRyYW5zYWN0aW9uIHNjcmVlbiI+CiAgICAgICAgPHByZT4KQ1VTVE9NRVIgVFJBTlNBQ1RJT04gSU5RVUlSWSBTWVNURU0gICAgICAgU1lTWgoKQUNDVCAjOiA0MTEwLTg4MjEtMzQ1MC05MTIxCk5BTUU6ICAgQUNNRSBDT1JQT1JBVElPTgoKUkVDRU5UIEFDVElWSVRZOgogLSAyMDI1LTEwLTE1ICBDUkVESVQgICAgICAkNTAsMDAwLjAwCiAtIDIwMjUtMTAtMTQgIERFQklUICAgICAgICQxMiwzNDUuNjcKClBGMT1IRUxQICBQRjM9RVhJVCAgUEY3PUJBQ0s8c3BhbiBjbGFzcz0iY3Vyc29yIj5fPC9zcGFuPgogICAgICAgIDwvcHJlPgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgogIDwvYm9keT4KPC9odG1sPgo=
    runcmd:
      - [bash, -c, "systemctl disable --now firewalld || true"]
      - [systemctl, enable, --now, nginx]
